---
title: "Databrary Volume Survey"
subtitle: "Preliminary summary"
author: "Rick Gilmore"
date: "`r Sys.time()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Purpose

This document provides preliminary results from a survey of all Databrary volumes conducted in October 2021 by members of the Gilmore lab team.

# Report strategy

1. Import data from the shared Google sheet.
2. Clean the data.
3. Summarize and visualize the data.

# Import

Data are stored in a shared Google sheet located at the following URL:

<https://docs.google.com/spreadsheets/d/1WXY82Xi4AGbNkClkqnUxCnxcrdnwLKU6Ki-9L9e3TbU/edit#gid=0>

We'll use the `googlesheets4` package in the `googledrive` package.

Check to see if package is installed, and if not, install it.

```{r}
if(!require(googledrive)) {
  install.packages('googledrive')
}
```

Next, we need to authenticate to Google Drive.

It's best to run this in the console, so we turn `eval=FALSE` for this chunk.

```{r authenticate-to-google, eval=FALSE}
googledrive::drive_auth()
```

Also, I recommend answering `No` when asked "Is it OK to cache OAuth access credentials in the folder ~/Library/Caches/gargle between R sessions?"

```{r}
vols_data_dribble <- googlesheets4::gs4_find(pattern="databrary\\-volume\\-survey")
```

We can then view metadata about the sheet.

```{r}
vols_data_dribble
```

Since we now know the Google-unique identifier, we can access it directly (and more quickly).

```{r}
vols_sheet_id <- vols_data_dribble$id
vols_data_drib_2 <- googledrive::drive_get(id = vols_sheet_id)
```

Now we can download the file.

```{r}
googledrive::drive_download(file = 'databrary-volume-survey', path = 'csv/databrary-volume-survey', type = 'csv', overwrite = TRUE)
```
Now, we can import it into R.

```{r}
vols_df <- readr::read_csv('csv/databrary-volume-survey.csv')
str(vols_df)
```

# Visualize

```{r}
xtabs(~ coder + sharing_level, data = vols_df)
```

